import{a as D,r as s,e as P,J as i,b as A,f as H,N as J,h as c,i as E,y as o,j as l,k as r,F as q,u as d,c as Q,B as W,E as X,m as Y,a2 as Z,C as ee,D as oe,o as $,A as N,x as te,G as ae}from"./entry.b3d0478f.js";import le from"./weixinScan.cfa18dfe.js";import{l as ne}from"./loginbg.c2d5a2fb.js";import se from"./imageCode.e7d995d7.js";import"./_commonjsHelpers.86de73f2.js";import"./_commonjs-dynamic-modules.302442b1.js";const v=m=>(ee("data-v-de0c5c98"),m=m(),oe(),m),ue={class:"login-main"},re={class:"logo"},ie=["src"],ce={class:"login-area"},de=v(()=>o("div",{class:"title-name"},"注册新账号",-1)),ve={class:"form"},me={class:"code"},pe={class:"name"},ge=v(()=>o("span",null,"已有账号,",-1)),_e={class:"agree"},fe=v(()=>o("div",null,"登录或注册即代表同意",-1)),he=["href"],Ce=v(()=>o("div",null,"和",-1)),ye=["href"],be=v(()=>o("div",{class:"login-bottom"},[o("div",null,"搜索无限可能！")],-1)),ke=D({__name:"register",setup(m){const{Modal:M}=X,{proxy:e}=Y(),R=s(),b=s(0),U=P(),z=i("authtoken"),t=s({captchaCode:"",accountNumber:"",registerCode:"",password:"",secretKey:i("secretKey").value?i("secretKey").value:""}),k=A(),I=s(""),p=s(!1),V=s(!1),g=s("获取验证码"),_=s(null),f=s(!1),x=s("");i("authtoken").value=null,H(()=>{T()});const w=s(ne),T=()=>{let n={advertBoardCode:"LOGIN_BACKGROUP"};e.$api1.banner_list_photo(n).then(a=>{a.resultObj.length>0&&(w.value=a.resultObj[0].advertBgPhoto)})},h=s(),F=()=>{t.value.accountNumber.length==11&&h.value.getCodeImg(t.value.accountNumber,"REGISTER")},K=e.$debounce(()=>{if(g.value!=="获取验证码")return;if(clearInterval(_.value),e.$isEmpty(t.value.accountNumber))return e.$Message.error("请输入您的手机号");if(e.$isEmpty(h.value.captchaCode))return e.$Message.error("请输入图形验证码");p.value=!0;let n={captchaCode:h.value.captchaCode,account:t.value.accountNumber,sendCodeType:"REGISTER"};e.$api.tenant_sendRegisterCode(n).then(a=>{p.value=!1,O()}).catch(()=>{p.value=!1})},500),O=()=>{clearInterval(_.valuer);let n=90;_.value=setInterval(()=>{n!==0?(g.value=n+"s",n--):(n=90,g.value="获取验证码",clearInterval(_.value))},1e3)},G=e.$debounce(()=>{if(e.$isEmpty(t.value.accountNumber)){e.$Message.error("请输入您的手机号");return}if(e.$isEmpty(t.value.registerCode)){e.$Message.error("请输入验证码");return}if(e.$isEmpty(t.value.password)){e.$Message.error("请设置密码");return}if(x.value!==t.value.password){e.$Message.error("重复输入密码错误");return}if(!V.value){e.$Message.error("请阅读并同意用户服务协议、隐私政策");return}f.value=!0,e.$api.tenant_register(t.value).then(n=>{f.value=!1,I.value=n.data.resultHint,z.value=JSON.stringify(n.data),U.push("/"),i("secretKey").value=null,e.$isEmpty(I.value)||setTimeout(()=>{M.confirm({okText:"我知道了",cancelText:"",content:I.value})},3e3)}).catch(n=>{n.resultCode==10007&&(i("secretKey").value=null),f.value=!1})},500);return J(()=>{}),(n,a)=>{const S=Z,C=c("Input"),y=c("FormItem"),B=c("Button"),L=c("Form"),j=c("Checkbox");return $(),E("div",{class:"login",style:W("background-image: url("+w.value+");")},[o("div",ue,[l(S,{to:"/"},{default:r(()=>[o("div",re,[o("img",{class:"login-main-img",src:d(k).configuration.loginLogo},null,8,ie)])]),_:1}),o("div",ce,[b.value!=3?($(),E(q,{key:0},[de,o("div",ve,[l(L,null,{default:r(()=>[l(y,null,{default:r(()=>[l(C,{size:"large",maxlength:11,modelValue:t.value.accountNumber,"onUpdate:modelValue":a[0]||(a[0]=u=>t.value.accountNumber=u),onOnChange:F,oninput:t.value.accountNumber=t.value.accountNumber.replace(/[^\d]/g,""),placeholder:"手机号"},null,8,["modelValue","oninput"])]),_:1}),l(y,null,{default:r(()=>[l(se,{ref_key:"imgCode",ref:h},null,512),o("div",me,[l(C,{size:"large",modelValue:t.value.registerCode,"onUpdate:modelValue":a[1]||(a[1]=u=>t.value.registerCode=u),placeholder:"验证码"},null,8,["modelValue"]),l(B,{size:"large",class:"btn",loading:p.value,onClick:d(K)},{default:r(()=>[N(te(g.value),1)]),_:1},8,["loading","onClick"])])]),_:1}),l(y,null,{default:r(()=>[l(C,{size:"large",type:"password",modelValue:t.value.password,"onUpdate:modelValue":a[2]||(a[2]=u=>t.value.password=u),placeholder:"设置密码"},null,8,["modelValue"])]),_:1}),l(y,null,{default:r(()=>[l(C,{size:"large",type:"password",modelValue:x.value,"onUpdate:modelValue":a[3]||(a[3]=u=>x.value=u),placeholder:"重复密码"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",pe,[o("div",null,[ge,o("span",null,[l(S,{to:"/login"},{default:r(()=>[N("立即登录")]),_:1})])])]),l(B,{class:"btn",type:"primary",size:"large",loading:f.value,onClick:d(G)},{default:r(()=>[N("注册")]),_:1},8,["loading","onClick"]),o("div",_e,[l(j,{modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=u=>V.value=u)},null,8,["modelValue"]),fe,o("a",{href:d(k).configuration.userServiceLink},"用户服务协议",8,he),Ce,o("a",{href:d(k).configuration.privacyPolicy},"隐私政策",8,ye)])],64)):($(),Q(le,{key:1,ref_key:"weixinScanRef",ref:R,active:b.value,"onUpdate:active":a[5]||(a[5]=u=>b.value=u)},null,8,["active"]))]),be])],4)}}});const Se=ae(ke,[["__scopeId","data-v-de0c5c98"]]);export{Se as default};
